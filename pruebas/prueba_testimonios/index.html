<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Carrusel de Testimonios GSAP - 3 Tarjetas</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap">
  <style>
    body {
      background: #54a8c7;
      font-family: 'Montserrat', sans-serif;
      margin: 0;
      padding: 0;
    }
    .carousel-container {
      max-width: 900px;
      margin: 90px auto 0 auto;
      position: relative;
      padding: 80px 0 40px 0;
      height: 370px;
      overflow: visible;
    }
    .carousel-track {
      position: relative;
      width: 100%;
      height: 320px;
      display: flex;
      justify-content: center;
      align-items: center;
      pointer-events: none;
    }
    .testimonial {
      position: absolute;
      width: 340px;
      max-width: 90vw;
      height: 310px;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.13);
      padding: 42px 28px 34px 28px;
      text-align: center;
      opacity: 0;
      z-index: 1;
      transform: scale(0.8) translateX(0px);
      transition: box-shadow 0.3s;
      pointer-events: none;
      filter: blur(2px) grayscale(0.3);
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      box-sizing: border-box;
    }
    .testimonial.center {
      opacity: 1;
      transform: scale(1) translateX(0px);
      z-index: 10;
      filter: none;
      pointer-events: auto;
      box-shadow: 0 12px 48px 0 rgba(31, 38, 135, 0.16);
    }
    .testimonial.left {
      opacity: 1;
      transform: scale(0.88) translateX(-230px);
      z-index: 5;
    }
    .testimonial.right {
      opacity: 1;
      transform: scale(0.88) translateX(230px);
      z-index: 5;
    }
    .avatar {
      width: 62px;
      height: 62px;
      border-radius: 50%;
      border: 4px solid #fff;
      margin: -62px auto 10px auto;
      object-fit: cover;
      box-shadow: 0 4px 16px rgba(0,0,0,0.07);
      background: #eee;
    }
    .name {
      font-weight: 700;
      font-size: 1.2em;
      margin-top: 12px;
    }
    .role {
      color: #999;
      font-size: 0.98em;
      margin-bottom: 18px;
    }
    .text {
      font-size: 1.08em;
      color: #444;
      margin-bottom: 10px;
      line-height: 1.6;
    }
    .indicators {
      margin-top: 30px;
      text-align: center;
    }
    .indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      margin: 0 8px;
      background: #fff;
      border-radius: 50%;
      border: 2px solid #4ba9c9;
      cursor: pointer;
      opacity: 0.7;
      transition: background 0.2s, opacity 0.2s;
    }
    .indicator.active {
      background: #4ba9c9;
      opacity: 1;
    }
    @media (max-width: 600px) {
      .carousel-container {
        height: 360px;
        max-width: 99vw;
      }
      .testimonial {
        width: 94vw;
        min-width: 220px;
        padding: 28px 8px 24px 8px;
      }
      .testimonial.left, .testimonial.right {
        transform: scale(0.85) translateX(-130px);
      }
      .testimonial.right {
        transform: scale(0.85) translateX(130px);
      }
    }
  </style>
</head>
<body>
  <div class="carousel-container">
    <div class="carousel-track"></div>
    <div class="indicators"></div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script>
    // Testimonios de ejemplo
    const data = [
      {
        avatar: "https://randomuser.me/api/portraits/women/44.jpg",
        name: "Maria Menounos",
        role: "Actriz & TV Host",
        text: "I feel on top of the world. I feel incredibly motivated. I feel empowered. I am the creator of my own destiny."
      },
      {
        avatar: "https://randomuser.me/api/portraits/women/45.jpg",
        name: "Serena Williams",
        role: "American Professional Tennis Player",
        text: "Tony Robbins helped me discover what I am really made of. With Tony's help, I've set new standards for myself, and I've taken my tennis game–and my life–to a whole new level!"
      },
      {
        avatar: "https://randomuser.me/api/portraits/men/46.jpg",
        name: "Marc Benioff",
        role: "Chairman and CEO of Salesforce",
        text: "Tony Robbins and his strategies and his tools, are at the core of our culture from the beginning. He has been one of the critical keys to Salesforce.com's leadership in cloud computing growth."
      }
    ];

    const carouselTrack = document.querySelector('.carousel-track');
    const indicatorsContainer = document.querySelector('.indicators');
    let current = 0;
    let running = false;

    // Crear indicadores dinámicamente
    function renderIndicators() {
      indicatorsContainer.innerHTML = '';
      data.forEach((_, i) => {
        const el = document.createElement('span');
        el.className = 'indicator' + (i === current ? ' active' : '');
        el.addEventListener('click', () => {
          if (i === current || running) return;
          animateTransition(i, i > current || (i === 0 && current === data.length-1) ? 1 : -1);
        });
        indicatorsContainer.appendChild(el);
      });
    }

    // Obtener índices de tarjetas izquierda, centro y derecha
    function getIndices(center, total) {
      const left = (center - 1 + total) % total;
      const right = (center + 1) % total;
      return {left, center, right};
    }

    // Renderizar las tarjetas
    function renderCards(centerIdx) {
      carouselTrack.innerHTML = '';
      const {left, center, right} = getIndices(centerIdx, data.length);
      const positions = ['left', 'center', 'right'];
      [left, center, right].forEach((idx, pos) => {
        const t = document.createElement('div');
        t.classList.add('testimonial');
        t.classList.add(positions[pos]);
        t.innerHTML = `
          <img class="avatar" src="${data[idx].avatar}" alt="${data[idx].name}">
          <div class="name">${data[idx].name}</div>
          <div class="role">${data[idx].role}</div>
          <div class="text">${data[idx].text}</div>
        `;
        carouselTrack.appendChild(t);
      });
    }

    // Animar la transición horizontal
    function animateTransition(nextIdx, direction = 1) {
      if (running) return;
      running = true;
      const testimonials = document.querySelectorAll('.testimonial');
      const oldCenter = testimonials[1];

      // Animar el centro hacia la izquierda/derecha y desvanecerlo
      gsap.to(oldCenter, {
        x: direction > 0 ? -230 : 230,
        scale: 0.88,
        opacity: 0.8,
        filter: "blur(2px) grayscale(0.3)",
        duration: 0.45,
        ease: "power2.in",
        onComplete: () => {
          renderCards(nextIdx);
          const newTestimonials = document.querySelectorAll('.testimonial');
          const newCenter = newTestimonials[1];
          gsap.fromTo(newCenter,
            {x: direction > 0 ? 230 : -230, scale: 0.88, opacity: 0.8, filter: "blur(2px) grayscale(0.3)"},
            {x: 0, scale: 1, opacity: 1, filter: "none", duration: 0.5, ease: "power2.out", onComplete: () => {
              running = false;
            }}
          );
        }
      });
      // Actualizar indicadores
      current = nextIdx;
      renderIndicators();
    }

    // Inicializar
    renderCards(current);
    renderIndicators();

    // Auto-play opcional
    setInterval(() => {
      if (running) return;
      const next = (current + 1) % data.length;
      animateTransition(next, 1);
    }, 6000);
  </script>
</body>
</html>